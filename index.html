<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ÄÄƒng kÃ½ ca lÃ m</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #eafafa;
      padding: 20px;
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #eee;
      text-align: center;
    }
    select, input {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 90%;
    }
    button {
      margin-top: 15px;
      width: 100%;
      padding: 12px;
      background: #0aa;
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<h2>ğŸ“… ÄÄƒng kÃ½ ca lÃ m trong tuáº§n</h2>

<input id="name" placeholder="TÃªn nhÃ¢n viÃªn" />

<table>
  <tr>
    <th>Thá»©</th>
    <th>Ca</th>
  </tr>

  <tbody id="schedule"></tbody>
</table>

<button onclick="submitSchedule()">XÃ¡c nháº­n Ä‘Äƒng kÃ½</button>

<!-- FIREBASE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCK6yfVr9VBMGwhbvYMXkJqMoRjo4Om2LM",
    authDomain: "an-quy.firebaseapp.com",
    databaseURL: "https://an-quy-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "an-quy",
    storageBucket: "an-quy.firebasestorage.app",
    messagingSenderId: "672469940026",
    appId: "1:672469940026:web:a38e5b15bbeb2361b84203"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const days = ["T2","T3","T4","T5","T6","T7","CN"];
  const tbody = document.getElementById("schedule");

  days.forEach(d => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${d}</td>
      <td>
        <select id="${d}">
          <option value="">â€” KhÃ´ng lÃ m â€”</option>
          <option value="C1">C1</option>
          <option value="C2">C2</option>
          <option value="C3">C3</option>
          <option value="2C_C1_C2">2C (C1 + C2)</option>
          <option value="2C_C2_C3">2C (C2 + C3)</option>
        </select>
      </td>
    `;
    tbody.appendChild(tr);
  });

  window.submitSchedule = function () {
    const name = document.getElementById("name").value.trim();
    if (!name) {
      alert("Vui lÃ²ng nháº­p tÃªn");
      return;
    }

    const data = {};
    days.forEach(d => {
      const val = document.getElementById(d).value;
      if (val) data[d] = val;
    });

    set(ref(db, "dangKy/" + name), {
      ten: name,
      lich: data,
      time: Date.now()
    })
    .then(() => alert("âœ… ÄÃ£ gá»­i lá»‹ch Ä‘Äƒng kÃ½"))
    .catch(err => alert("âŒ Lá»—i: " + err.message));
  };
</script>

</body>
</html>
